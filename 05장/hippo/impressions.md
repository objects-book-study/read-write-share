해당 장에서는 책임 주도 설계를 어떻게 진행하는 가에 대해서 알아보았다.

인상 깊었던 내용은 아래와 같다.

### 변경의 이유가 하나 이상인 클래스를 찾는 방법

1. 인스턴스 변수가 초기화되는 시점을 살펴보자
    - 응집도가 높은 클래스는 인스턴스를 생성할 때 모든 속성을 함께 초기화한다.
    - 반면 응집도가 낮은 클래스는 객체의 속성 중 일부만 초기화하고 일부는 초기화되지 않은 상태로 남겨진다.
    - **함께 초기화되는 속성을 기준으로 코드를 분리해야 한다.**

2. 메서드들이 인스턴스 변수를 사용하는 방식을 살펴보는 것이다.
    - 모든 메서드가 객체의 모든 속성을 사용한다면 클래스의 응집도는 높다고 볼 수 있다.
    - 메서드들이 사용하는 속성에 따라 그룹이 나뉜다면 클래스의 응집도가 낮다고 볼 수 있다.
    - **속성 그룹과 해당 그룹에 접근하는 메서드 그룹을 기준으로 코드를 분리해야 한다.**

> 클래스 응집도 판단하기
>
> 클래스가 하나 이상의 이유로 변경돼야 한다면 응집도가 낮은 것이다. 변경의 이유를 기준으로 클래스를 분리하라
>
> 클래스의 인스턴스를 초기화하는 시점에 경우에 따라 서로 다른 속성들을 초기화하고 있다면 응집도가 낮은 것이다. 초기화되는 속성의 그룹을 기준으로 클래스를 분리하라.
>
> 메서드 그룹이 속성 그룹을 사용하는지 여부로 나뉜다면 응집도가 낮은 것이다. 이들 그룹을 기준으로 클래스를 분리하라.


---

> POLYMORPHISM(다형성) 패턴
>
> 객체의 타입에 따라 변하는 로직이 있을 때 변하는 로직을 담당할 책임을 어떻게 할당해야 하는가?
>
> 타입을 명시적으로 정의하고 각 타입에 다형적으로 행동하는 책임을 할당하라.
>
> 객체의 타입을 검사해서 타입에 따라 여러 대안들을 수행하는 조건적인 논리를 사용하지 말자.
>
> 대신 다형성을 이용해 새로운 변화를 다루기 쉽게 확장하자!

---

> PROTECTED VARIATIONS (변경 보호) 패턴
>
> 객체, 서브시스템, 그리고 시스템을 어떻게 설계해야 변화와 불안정성이 다른 요소에 나쁜 영향을 미치지 않도록 방지할 수 있을까?
>
> 변화가 예상되는 불안정한 지점들을 식별하고 그 주위에 안정된 인터페이스를 형성하도록 책임을 할당하라.
>
> PROTECTED VARIATIONS 패턴은 책임 할당의 관점에서 캡슐화를 설명한 것이다.
>
> 우리가 캡슐화해야 하는 것은 변경이다. 변경이 될 가능성이 높은가? 그렇다면 캡슐화하라!
 
---

### 도메인의 구조가 코드의 구조를 이끈다.

도메인 모델은 단순히 설계에 필요한 용어를 제공하는 것을 넘어 코드의 주고에도 영향을 미친다.

변경 역시 도메인 모델의 일부이다.

도메인 모델에는 모데인 안에서 변하는 개념과 이들 사이의 관계가 투영돼 있어야 한다.

그림 5.1의 도메인 모델에는 할인 정책과 할인 조건이 변경될 수 있다는 도메인에 대한 직관이 반영돼 있다.

그리고 이 직관이 우리의 설계가 가져야 하는 유연성을 이끌었다.

다시 한번 강조하지만 구현을 가이드할 수 있는 도메인 모델을 선택하라.

객체지향은 도메인의 개념과 구조를 반영한 코드를 가능하게 만들기 때문에 도메인의 구조가 코드의 구조를 이끌어 내는 것은 자연스러운뿐만 아니라 바람직한 것이다.

---

처음부터 책임 주도 설계를 완벽하게 해내는 것은 어렵다고 생각된다.

그리고 이를 고려한 도메인 모델을 설계하는 것 또한 매우 어려운 일이다.

목적을 달성할 수 있는 정도의 설계 및 구현을 진행하고 상황 및 필요에 따라 적절히 리펙토링하며 도메인 모델 또한 변경하는 것이 중요하다!

항상 유연하게 접근하자!